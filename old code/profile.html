<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - DeK.</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="top-nav">
        <a href="index.html" class="logo">DeK.</a>
        <div class="nav-links">
            <a href="index.html">NEWS</a>
            <a href="educate.html">Educate</a>
            <a href="guide.html">Guide</a>
            <a href="camp.html">Camp</a>
            <a href="interview.html">Interview</a>
            <a href="attribute.html">Attribute</a>
            <a href="profile.html" class="active">Profile</a>
        </div>
        <div class="profile-icon">
            <img src="default-profile.png" alt="Profile" id="profileImage" class="profile-image">
            <div class="profile-dropdown">
                <a href="profile.html">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</a>
                <a href="#" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</a>
            </div>
        </div>
    </nav>

    <div class="profile-container">
        <div class="profile-header">
            <div class="profile-cover">
                <div class="profile-avatar">
                    <img src="default-profile.png" alt="Profile" id="avatarImage">
                    <div class="avatar-overlay">
                        <label for="avatarUpload" class="upload-button">
                            <span>üì∑ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ</span>
                        </label>
                        <input type="file" id="avatarUpload" accept="image/*" style="display: none;">
                    </div>
                </div>
            </div>
            <h2 id="profileUsername">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</h2>
        </div>

        <div class="profile-tabs">
            <button class="tab-button active" data-tab="info">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</button>
            <button class="tab-button" data-tab="education">‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</button>
            <button class="tab-button" data-tab="interests">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à</button>
        </div>

        <div class="profile-content">
            <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß -->
            <div class="tab-content active" id="info">
                <form id="profileForm" class="profile-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
                            <input type="text" id="username" readonly>
                        </div>
                        <div class="form-group">
                            <label>‡∏≠‡∏µ‡πÄ‡∏°‡∏•</label>
                            <input type="email" id="email">
                        </div>
                    </div>
                </form>
            </div>

            <!-- ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ -->
            <div class="tab-content" id="education">
                <form class="profile-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label>
                            <select id="education-year" required>
                                <option value="m4">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4</option>
                                <option value="m5">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 5</option>
                                <option value="m6">‡∏°‡∏±‡∏ò‡∏¢‡∏°‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏õ‡∏µ‡∏ó‡∏µ‡πà 6</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ (GPAX)</label>
                            <input type="number" id="gpa" step="0.01" min="0" max="4">
                        </div>
                        <div class="form-group full-width">
                            <label>‡∏™‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
                            <div class="radio-group">
                                <label class="radio-button">
                                    <input type="radio" name="study-program" value="science">
                                    <span>‡∏ß‡∏¥‡∏ó‡∏¢‡πå-‡∏Ñ‡∏ì‡∏¥‡∏ï</span>
                                </label>
                                <label class="radio-button">
                                    <input type="radio" name="study-program" value="arts-math">
                                    <span>‡∏®‡∏¥‡∏•‡∏õ‡πå-‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</span>
                                </label>
                                <label class="radio-button">
                                    <input type="radio" name="study-program" value="arts-lang">
                                    <span>‡∏®‡∏¥‡∏•‡∏õ‡πå-‡∏†‡∏≤‡∏©‡∏≤</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à -->
            <div class="tab-content" id="interests">
                <form class="profile-form">
                    <div class="form-group">
                        <label>‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à</label>
                        <div class="tag-input">
                            <input type="text" id="universityInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏´‡∏≤‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏Å‡∏î Enter">
                            <div id="universityTags" class="tags-container"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>‡∏Ñ‡∏ì‡∏∞‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à</label>
                        <div class="tag-input">
                            <input type="text" id="facultyInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏ì‡∏∞‡πÅ‡∏•‡∏∞‡∏Å‡∏î Enter">
                            <div id="facultyTags" class="tags-container"></div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à</label>
                        <div class="checkbox-grid">
                            <label class="checkbox-button">
                                <input type="checkbox" name="admission-round" value="portfolio">
                                <span>Portfolio</span>
                            </label>
                            <label class="checkbox-button">
                                <input type="checkbox" name="admission-round" value="quota">
                                <span>Quota</span>
                            </label>
                            <label class="checkbox-button">
                                <input type="checkbox" name="admission-round" value="admission">
                                <span>Admission</span>
                            </label>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <div class="profile-actions">
            <button type="button" class="save-button" onclick="saveProfile()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
    </div>

    <script>
    // ‡πÄ‡∏û‡∏¥‡πà‡∏° JavaScript ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ tabs
    document.querySelectorAll('.tab-button').forEach(button => {
        button.addEventListener('click', () => {
            document.querySelectorAll('.tab-button').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            button.classList.add('active');
            document.getElementById(button.dataset.tab).classList.add('active');
        });
    });

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
    function loadUserProfile() {
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (!currentUser || !currentUser.isLoggedIn) {
            window.location.href = 'login.html';
            return;
        }

        const users = JSON.parse(localStorage.getItem('users') || '{"users": []}');
        const user = users.users.find(u => u.username === currentUser.username);

        if (user) {
            document.getElementById('profileUsername').textContent = user.username;
            document.getElementById('username').value = user.username;
            document.getElementById('education-year').value = user.education_year || '';
            document.getElementById('gpa').value = user.gpa || '';
            
            if (user.study_program) {
                document.querySelector(`input[name="study-program"][value="${user.study_program}"]`).checked = true;
            }

            if (user.profileImage) {
                document.getElementById('avatarImage').src = user.profileImage;
                const navProfileImage = document.getElementById('profileImage');
                if (navProfileImage) {
                    navProfileImage.src = user.profileImage;
                }
            }
        }
    }

    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    function saveProfile() {
        const currentUser = JSON.parse(localStorage.getItem('currentUser'));
        if (!currentUser) return;

        const users = JSON.parse(localStorage.getItem('users') || '{"users": []}');
        const userIndex = users.users.findIndex(u => u.username === currentUser.username);

        if (userIndex !== -1) {
            const updatedUser = {
                ...users.users[userIndex],
                education_year: document.getElementById('education-year').value,
                gpa: document.getElementById('gpa').value,
                study_program: document.querySelector('input[name="study-program"]:checked')?.value,
                admission_rounds: Array.from(document.querySelectorAll('input[name="admission-round"]:checked')).map(cb => cb.value)
            };

            users.users[userIndex] = updatedUser;
            localStorage.setItem('users', JSON.stringify(users));
            alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        }
    }

    // ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
    document.getElementById('avatarUpload').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageData = e.target.result;
                document.getElementById('avatarImage').src = imageData;
                document.getElementById('profileImage').src = imageData;
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏π‡∏õ‡∏•‡∏á localStorage
                const currentUser = JSON.parse(localStorage.getItem('currentUser'));
                if (currentUser) {
                    const users = JSON.parse(localStorage.getItem('users') || '{"users": []}');
                    const userIndex = users.users.findIndex(u => u.username === currentUser.username);
                    if (userIndex !== -1) {
                        users.users[userIndex].profileImage = imageData;
                        localStorage.setItem('users', JSON.stringify(users));
                    }
                }
            };
            reader.readAsDataURL(file);
        }
    });

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
    document.addEventListener('DOMContentLoaded', loadUserProfile);

    // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    function logout() {
        localStorage.removeItem('currentUser');
        setTimeout(() => {
            window.location.href = 'login.html';
        }, 100);
    }
    </script>
</body>
</html> 